dependencies:
  pre:
    - git clone https://github.com/nomad/cupertino
    - gem install cupertino
    - ios profiles:download "$DEV_PROVIOSNING_PROFILE" -u $APPLE_USER -p $APPLE_PASS
#    - ios certificates:download $APPLE_CERT -u $APPLE_USER -p $APPLE_PASS
#test:
#  override:
#    - xctool
#      -reporter pretty
#      -reporter junit:$CIRCLE_TEST_REPORTS/xcode/results.xml
#      -reporter plain:$CIRCLE_ARTIFACTS/xctool.log
#      CODE_SIGNING_REQUIRED=YES
#      CODE_SIGN_IDENTITY=$DEV_PROVIOSNING_PROFILE
#      PROVISIONING_PROFILE=$DEV_PROVIOSNING_PROFILE
#      -destination 'platform=iOS Simulator,name=iPhone 6,OS=latest'
#      -sdk iphonesimulator
#      -workspace project.xcworkspace
#      -scheme "My scheme"
#      build build-tests run-tests

test:
  override:
    - set -o pipefail &&
      xcodebuild
        CODE_SIGNING_REQUIRED=YES
        CODE_SIGN_IDENTITY=$DEV_PROVIOSNING_PROFILE
        PROVISIONING_PROFILE=$DEV_PROVIOSNING_PROFILE
        -sdk iphonesimulator
        -destination 'platform=iOS Simulator,OS=8.1,name=iPhone 6'
        -workspace MyWorkspace.xcworkspace
        -scheme "My Scheme"
        clean build test |
      tee $CIRCLE_ARTIFACTS/xcode_raw.log |
      xcpretty --color --report junit --output $CIRCLE_TEST_REPORTS/xcode/results.xml
